modification from branch 2